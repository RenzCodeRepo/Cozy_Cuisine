@model Cozy_Cuisine.ViewModels.DashboardVM2

@{
    Layout = "Admin_Layout";
    ViewData["Title"] = "Dashboard";
}
<link href="~/css/dashboard.css" rel="stylesheet" />

<div class="pgnamecont container mb-3 p-0">
    <div class="dashboard display-6 m-0">Dashboard</div>
    <div class="dlcont text-center p-2">
        <div class="statsnum dlnum fs-3 mb-1" data-target="@Model.TotalDownloads">
            @Model.TotalDownloads
        </div>
        <div class="dltext">Downloads</div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="stats col-lg-3 p-3 mb-2">
            <div class="statsdesc"><i class="iconstats fa-solid fa-user fa-2xl"></i>Active Users</div>
            <div class="statsnum fs-3 py-2" data-target="12">0</div>
        </div>
        <div class="stats col-lg-3 p-3 mb-2">
            <div class="statsdesc"><i class="iconstats fa-solid fa-star fa-2xl"></i>Ratings</div>
            <div class="statsnum fs-3 py-2" data-target="@Model.Ratings.ToString("0.0")"> @Model.Ratings.ToString("0.0")</div>
        </div>
        <div class="stats col-lg-3 p-3 mb-2">
            <div class="statsdesc"><i class="iconstats fa-solid fa-clock fa-2xl"></i>Daily Visits</div>
            <div class="statsnum fs-3 py-2" data-target="@Model.DailyVisits">@Model.DailyVisits</div>
        </div>
    </div>
</div>

<div class="acts container fs-5 mt-3 pt-3">
    Graphs and Tables
</div>

<div class="container mt-4">
    <ul class="recentnavtabs nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="recenttabs nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1" type="button" role="tab">Ratings</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="recenttabs nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2" type="button" role="tab">Visitors</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="recenttabs nav-link" id="tab3-tab" data-bs-toggle="tab" data-bs-target="#tab3" type="button" role="tab">Commments</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="recenttabs nav-link" id="tab4-tab" data-bs-toggle="tab" data-bs-target="#tab4" type="button" role="tab">Bug Reports</button>
        </li>
    </ul>
    <div class="tab-content mt-3" id="myTabContent">
        <!--updates-->
        <div class="tab-pane fade show active" id="tab1" role="tabpanel">
            <table class="table table-bordered table-hover table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Image</th>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Date Created</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>101</td>
                        <td><img src="~/img/logo.png" /></td>
                        <td>New Recipes Added! 🍳</td>
                        <td>Introducing 10 new recipes, including sushi & burgers!</td>
                        <td>2025-03-13</td>
                        <td>Released</td>
                        <td>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-eye fa-sm"></i> View</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-pen-to-square fa-sm"></i> Edit</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-trash fa-sm"></i> Delete</button>
                        </td>
                    </tr>
                    <tr>
                        <td>ID</td>
                        <td>Image</td>
                        <td>Title</td>
                        <td>Description</td>
                        <td>Date Created</td>
                        <td>Status</td>
                        <td>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-eye fa-sm"></i> View</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-pen-to-square fa-sm"></i> Edit</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-trash fa-sm"></i> Delete</button>
                        </td>
                    </tr>
                    <tr>
                        <td>101</td>
                        <td><img src="~/img/logo.png" /></td>
                        <td>New Recipes Added! 🍳</td>
                        <td>Introducing 10 new recipes, including sushi & burgers!</td>
                        <td>2025-03-13</td>
                        <td>Released</td>
                        <td>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-eye fa-sm"></i> View</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-pen-to-square fa-sm"></i> Edit</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-trash fa-sm"></i> Delete</button>
                        </td>

                    </tr>
                    <tr>
                        <td>101</td>
                        <td><img src="~/img/logo.png" /></td>
                        <td>New Recipes Added! 🍳</td>
                        <td>Introducing 10 new recipes, including sushi & burgers!</td>
                        <td>2025-03-13</td>
                        <td>Released</td>
                        <td>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-eye fa-sm"></i> View</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-pen-to-square fa-sm"></i> Edit</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-trash fa-sm"></i> Delete</button>
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>
        <!--comments-->
        <div class="tab-pane fade" id="tab2" role="tabpanel">
            <table class="table table-bordered table-hover table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Messages</th>
                        <th>Images</th>
                        <th>Posted Date</th>
                        <th>Updated Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ID</td>
                        <td>Messages</td>
                        <td>Images</td>
                        <td>Posted Date</td>
                        <td>Updated Date</td>
                        <td>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-eye fa-sm"></i> View</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-pen-to-square fa-sm"></i> Edit</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-trash fa-sm"></i> Delete</button>
                        </td>
                    </tr>
                    <tr>
                        <td>ID</td>
                        <td>Messages</td>
                        <td>Images</td>
                        <td>Posted Date</td>
                        <td>Updated Date</td>
                        <td>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-eye fa-sm"></i> View</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-pen-to-square fa-sm"></i> Edit</button>
                            <button class="actionsbtn focus-ring btn btn-sm mb-1"><i class="fa-solid fa-trash fa-sm"></i> Delete</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!--bug reports-->
        <div class="tab-pane fade" id="tab3" role="tabpanel">
            <table class="table table-bordered table-hover table-striped" id="commentsTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Username</th>
                        <th>BugId</th>
                        <th>Message</th>
                        <th>URLImageList</th>
                        <th>Posted Date</th>
                        <th>Updated Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>
            </table>
            <script>
                $(document).ready(function() {
                    $('#commentsTable').DataTable({
                        processing: true,
                        serverSide: true,
                        ajax: {
                            url: '@Url.Action("GetAllComments", "Manage")',
                            type: 'GET'
                        },
                        columns: [
                            { data: 'commentId' }, // ID
                            { data: 'username', defaultContent: 'Anonymous' }, // Handle null usernames
                            { data: 'bugId' }, // Bug ID
                            { data: 'message' }, // Comment Message
                            {
                                data: 'urlImageList',
                                render: function(data) {
                                    if (data && data.length > 0) {
                                        return data.map(url => `<img src="${url}" width="50" height="50"/>`).join(' ');
                                    }
                                    return 'No images';
                                }
                            },
                            {
                                data: 'postedDate',
                                render: function(data) {
                                    return new Date(data).toLocaleString(); // Format date
                                }
                            },
                            {
                                data: 'updatedDate',
                                render: function(data) {
                                    return data ? new Date(data).toLocaleString() : 'Never Updated';
                                }
                            }
                        ],
                        paging: true,
                        searching: true,
                        ordering: true,
                        responsive: true
                    });
                });
            </script>
        </div>
        <!--user logs-->
        <div class="tab-pane fade" id="tab4" role="tabpanel">
            <table class="table table-bordered table-hover table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Username</th>
                        <th>Logged In</th>
                        <th>Logged Out</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ID</td>
                        <td>Username</td>
                        <td>Logged In</td>
                        <td>Logged Out</td>
                    </tr>
                    <tr>
                        <td>ID</td>
                        <td>Username</td>
                        <td>Logged In</td>
                        <td>Logged Out</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function animateNumbers() {
        const statsNums = document.querySelectorAll(".statsnum");

        statsNums.forEach((num) => {
            let target = parseFloat(num.getAttribute("data-target"));
            let current = 0;
            let step = target / 60; // Adjust speed

            let interval = setInterval(() => {
                current += step;
                if (current >= target) {
                    clearInterval(interval);
                    num.innerText = target; // Ensure it reaches the final number
                } else {
                    num.innerText = target % 1 === 0 ? Math.floor(current) : current.toFixed(1);
                }
            }, 20); // Adjust speed by changing the interval time
        });
    }

    window.onload = animateNumbers;
</script>